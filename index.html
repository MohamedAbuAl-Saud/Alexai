<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Alexai - محادثة الذكاء الاصطناعي الفاخرة</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github-dark.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            'luxury-gold': '#d4af37',
            'luxury-blue': '#2c6fbb',
            'luxury-dark': '#121212',
            'luxury-darker': '#0a0a0a',
            'luxury-light': '#1e1e1e'
          },
          fontFamily: {
            'display': ['Tajawal', 'sans-serif'],
            'body': ['Tajawal', 'sans-serif']
          }
        }
      }
    }
  </script>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    body {
      background: linear-gradient(135deg, #0a0a0a 0%, #121212 100%);
      color: #f0f0f0;
      min-height: 100vh;
      font-family: 'Tajawal', sans-serif;
      position: relative;
      overflow-x: hidden;
      transition: background 0.5s ease;
      font-size: 14px;
    }
    
    .glass-panel {
      background: rgba(30, 30, 46, 0.15);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      border: 1px solid rgba(212, 175, 55, 0.15);
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.2);
      border-radius: 12px;
      overflow: hidden;
    }
    
    .luxury-border {
      border: 1px solid rgba(212, 175, 55, 0.25);
    }
    
    .gold-gradient {
      background: linear-gradient(135deg, #d4af37 0%, #f9e076 100%);
    }
    
    .blue-moon {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 100px;
      height: 100px;
      background: radial-gradient(circle, #2c6fbb 0%, #0a2a55 70%, transparent 100%);
      border-radius: 50%;
      opacity: 0.3;
      z-index: -1;
    }
    
    .chat-bubble-user {
      background: linear-gradient(135deg, #2a2a2a 0%, #1e1e1e 100%);
      border: 1px solid rgba(212, 175, 55, 0.25);
      border-radius: 14px 14px 4px 14px;
      position: relative;
      font-size: 13px;
      padding: 12px;
    }
    
    .chat-bubble-bot {
      background: linear-gradient(135deg, #1a1a1a 0%, #121212 100%);
      border: 1px solid rgba(212, 175, 55, 0.2);
      border-radius: 14px 14px 14px 4px;
      position: relative;
      font-size: 13px;
      padding: 12px;
    }
    
    .status-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      position: absolute;
      bottom: 0;
      left: 0;
      border: 2px solid #121212;
    }
    
    .scrollbar-custom::-webkit-scrollbar {
      width: 6px;
    }
    
    .scrollbar-custom::-webkit-scrollbar-track {
      background: #1a1a1a;
      border-radius: 6px;
    }
    
    .scrollbar-custom::-webkit-scrollbar-thumb {
      background: rgba(212, 175, 55, 0.4);
      border-radius: 6px;
    }
    
    .pulse {
      animation: pulse 2s infinite;
    }
    
    @keyframes pulse {
      0% { box-shadow: 0 0 0 0 rgba(212, 175, 55, 0.2); }
      70% { box-shadow: 0 0 0 8px rgba(212, 175, 55, 0); }
      100% { box-shadow: 0 0 0 0 rgba(212, 175, 55, 0); }
    }
    
    .cookie-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.85);
      z-index: 1000;
      display: flex;
      justify-content: center;
      align-items: center;
      backdrop-filter: blur(5px);
    }
    
    .cookie-modal {
      background: rgba(26, 26, 38, 0.95);
      border: 1px solid rgba(212, 175, 55, 0.3);
      border-radius: 12px;
      padding: 20px;
      max-width: 400px;
      width: 90%;
      text-align: center;
      box-shadow: 0 12px 30px rgba(0,0,0,0.6);
      backdrop-filter: blur(10px);
    }
    
    .cookie-btn {
      padding: 10px 20px;
      border-radius: 6px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s ease;
      border: none;
      font-size: 13px;
      margin-top: 12px;
      width: 100%;
    }
    
    .accept-btn {
      background: linear-gradient(135deg, #2c6fbb 0%, #3a86ff 100%);
      color: white;
    }
    
    .reject-btn {
      background: rgba(42, 42, 42, 0.8);
      color: #f0f0f0;
      border: 1px solid rgba(212, 175, 55, 0.3);
    }
    
    .developer-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.85);
      z-index: 2000;
      display: flex;
      justify-content: center;
      align-items: center;
      backdrop-filter: blur(5px);
    }
    
    .developer-card {
      background: linear-gradient(135deg, #1a1a1a 0%, #121212 100%);
      border: 1px solid rgba(212, 175, 55, 0.3);
      border-radius: 12px;
      padding: 20px;
      max-width: 380px;
      width: 90%;
      text-align: center;
      box-shadow: 0 12px 30px rgba(0,0,0,0.6);
      position: relative;
    }
    
    .close-btn {
      position: absolute;
      top: 12px;
      left: 12px;
      background: transparent;
      border: none;
      color: #d4af37;
      font-size: 20px;
      cursor: pointer;
      width: 34px;
      height: 34px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
    }
    
    .close-btn:hover {
      background: rgba(212, 175, 55, 0.1);
    }
    
    .crown-icon {
      position: absolute;
      top: -12px;
      right: 50%;
      transform: translateX(50%);
      font-size: 28px;
      color: #d4af37;
    }
    
    .developer-avatar {
      width: 110px;
      height: 110px;
      border-radius: 50%;
      border: 2px solid #d4af37;
      margin: 0 auto 12px;
      object-fit: cover;
    }
    
    .telegram-btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 10px 20px;
      background: #2c6fbb;
      color: white;
      border-radius: 24px;
      text-decoration: none;
      margin-top: 16px;
      transition: all 0.3s ease;
      font-weight: 500;
      font-size: 14px;
    }
    
    .telegram-btn:hover {
      background: #3a86ff;
      transform: translateY(-2px);
    }
    
    .settings-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.85);
      z-index: 2000;
      display: flex;
      justify-content: center;
      align-items: center;
      backdrop-filter: blur(5px);
      overflow-y: auto;
      padding: 16px;
    }
    
    .settings-card {
      background: linear-gradient(135deg, #1a1a1a 0%, #121212 100%);
      border: 1px solid rgba(212, 175, 55, 0.3);
      border-radius: 12px;
      padding: 20px;
      max-width: 500px;
      width: 90%;
      box-shadow: 0 12px 30px rgba(0,0,0,0.6);
      position: relative;
    }
    
    .settings-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
      gap: 16px;
      margin-top: 16px;
    }
    
    .settings-item {
      background: rgba(42, 42, 42, 0.4);
      border-radius: 10px;
      padding: 14px;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s ease;
      border: 1px solid rgba(212, 175, 55, 0.2);
      font-size: 13px;
    }
    
    .settings-item:hover {
      transform: translateY(-2px);
      border-color: rgba(212, 175, 55, 0.5);
    }
    
    .settings-item i {
      font-size: 22px;
      margin-bottom: 8px;
      color: #d4af37;
    }
    
    .help-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.85);
      z-index: 2000;
      display: flex;
      justify-content: center;
      align-items: center;
      backdrop-filter: blur(5px);
    }
    
    .help-card {
      background: linear-gradient(135deg, #1a1a1a 0%, #121212 100%);
      border: 1px solid rgba(212, 175, 55, 0.3);
      border-radius: 12px;
      padding: 20px;
      max-width: 420px;
      width: 90%;
      box-shadow: 0 12px 30px rgba(0,0,0,0.6);
      position: relative;
    }
    
    .help-input {
      width: 100%;
      background: rgba(42, 42, 42, 0.4);
      border: 1px solid rgba(212, 175, 55, 0.2);
      border-radius: 10px;
      padding: 12px;
      color: white;
      margin-top: 12px;
      margin-bottom: 12px;
      font-size: 13px;
    }
    
    @media (max-width: 768px) {
      #chat-content {
        height: 55vh;
      }
      
      .chat-bubble-user, .chat-bubble-bot {
        max-width: 90%;
      }
      
      .developer-card, .settings-card, .help-card {
        padding: 16px;
      }
      
      .settings-grid {
        grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
      }
    }
    
    .copyright {
      position: absolute;
      bottom: 8px;
      left: 0;
      width: 100%;
      text-align: center;
      font-size: 10px;
      color: rgba(255, 255, 255, 0.4);
      z-index: 10;
    }
    
    .guest-warning {
      background: rgba(239, 68, 68, 0.15);
      border: 1px solid rgba(239, 68, 68, 0.3);
      padding: 8px 12px;
      border-radius: 6px;
      margin-top: 8px;
      text-align: center;
      font-size: 12px;
    }
    
    .code-block {
      background: rgba(10, 10, 10, 0.8);
      border: 1px solid rgba(212, 175, 55, 0.2);
      border-radius: 6px;
      padding: 12px;
      margin: 10px 0;
      position: relative;
      overflow-x: auto;
    }
    
    .code-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 8px;
      padding-bottom: 6px;
      border-bottom: 1px solid rgba(212, 175, 55, 0.1);
      font-size: 12px;
    }
    
    .copy-btn {
      background: rgba(212, 175, 55, 0.1);
      color: #d4af37;
      border: none;
      padding: 5px 10px;
      border-radius: 4px;
      cursor: pointer;
      transition: all 0.2s;
      font-size: 11px;
    }
    
    .copy-btn:hover {
      background: rgba(212, 175, 55, 0.2);
    }
    
    .copy-btn.copied {
      background: rgba(16, 185, 129, 0.2);
      color: #10b981;
    }
    
    pre {
      margin: 0;
      font-size: 12px;
      line-height: 1.4;
      color: #f0f0f0;
      white-space: pre-wrap;
    }
    
    .language-badge {
      background: rgba(44, 111, 187, 0.2);
      color: #3a86ff;
      padding: 3px 6px;
      border-radius: 3px;
      font-size: 11px;
      font-weight: 500;
    }
    
    .background-option {
      width: 100%;
      height: 75px;
      border-radius: 6px;
      cursor: pointer;
      margin-bottom: 10px;
      border: 2px solid transparent;
      transition: all 0.3s ease;
    }
    
    .background-option.selected {
      border-color: #d4af37;
    }
    
    .avatar-option {
      width: 55px;
      height: 55px;
      border-radius: 50%;
      cursor: pointer;
      margin: 6px;
      border: 2px solid transparent;
      transition: all 0.3s ease;
      object-fit: cover;
    }
    
    .avatar-option.selected {
      border-color: #d4af37;
    }
    
    .ai-avatar-option {
      width: 70px;
      height: 70px;
      border-radius: 50%;
      cursor: pointer;
      margin: 6px;
      border: 2px solid transparent;
      transition: all 0.3s ease;
      object-fit: cover;
    }
    
    .ai-avatar-option.selected {
      border-color: #d4af37;
    }
    
    .avatar-grid {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      margin-top: 14px;
    }
    
    .ping-badge {
      display: inline-block;
      padding: 3px 8px;
      border-radius: 8px;
      font-size: 11px;
      background: rgba(16, 185, 129, 0.15);
      color: #10b981;
      margin-right: 4px;
    }
    
    .message-actions {
      display: flex;
      justify-content: flex-start;
      gap: 10px;
      margin-top: 14px;
      padding-top: 10px;
      border-top: 1px solid rgba(212, 175, 55, 0.1);
    }
    
    .action-btn {
      background: rgba(0, 0, 0, 0.3);
      border: 1px solid rgba(212, 175, 55, 0.3);
      border-radius: 6px;
      padding: 6px 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      color: #d4af37;
      font-size: 11px;
      transition: all 0.2s ease;
    }
    
    .action-btn:hover {
      background: rgba(212, 175, 55, 0.2);
    }
    
    .save-notification {
      position: fixed;
      top: 16px;
      right: 50%;
      transform: translateX(50%);
      background: rgba(26, 26, 38, 0.9);
      border: 1px solid rgba(212, 175, 55, 0.3);
      border-radius: 6px;
      padding: 10px 20px;
      color: #d4af37;
      font-size: 13px;
      z-index: 3000;
      opacity: 0;
      transition: opacity 0.3s ease;
      pointer-events: none;
    }
    
    .save-notification.show {
      opacity: 1;
    }
    
    .sidebar {
      position: fixed;
      top: 0;
      right: -220px;
      height: 100%;
      width: 240px;
      background: rgba(18, 18, 18, 0.9);
      backdrop-filter: blur(10px);
      border-left: 1px solid rgba(212, 175, 55, 0.2);
      display: flex;
      flex-direction: column;
      padding: 16px;
      z-index: 100;
      transition: right 0.3s ease;
    }
    
    .sidebar.active {
      right: 0;
    }
    
    .sidebar-btn {
      width: 100%;
      border-radius: 6px;
      display: flex;
      align-items: center;
      padding: 12px 14px;
      margin-bottom: 14px;
      background: rgba(30, 30, 46, 0.3);
      border: 1px solid rgba(212, 175, 55, 0.2);
      color: #d4af37;
      font-size: 14px;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    
    .sidebar-btn:hover {
      background: rgba(212, 175, 55, 0.2);
      transform: translateX(-2px);
    }
    
    .sidebar-btn i {
      margin-left: 10px;
    }
    
    .info-card {
      background: rgba(30, 30, 46, 0.3);
      border: 1px solid rgba(212, 175, 55, 0.2);
      border-radius: 10px;
      padding: 12px;
      margin-top: 10px;
      font-size: 12px;
    }
    
    .info-item {
      display: flex;
      align-items: center;
      margin-bottom: 8px;
    }
    
    .info-item i {
      color: #d4af37;
      margin-left: 8px;
      width: 16px;
      text-align: center;
      font-size: 14px;
    }
    
    .menu-toggle {
      position: fixed;
      top: 16px;
      right: 16px;
      z-index: 101;
      background: rgba(30, 30, 46, 0.5);
      border: 1px solid rgba(212, 175, 55, 0.3);
      border-radius: 6px;
      width: 45px;
      height: 45px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      color: #d4af37;
      font-size: 22px;
    }
    
    .message-container {
      margin-bottom: 20px;
    }
    
    .form-container {
      max-width: 400px;
      width: 100%;
    }
    
    .form-input {
      width: 100%;
      background: rgba(30, 30, 46, 0.3);
      border: 1px solid rgba(212, 175, 55, 0.3);
      border-radius: 10px;
      padding: 12px;
      color: white;
      margin-bottom: 14px;
      font-size: 13px;
    }
    
    .form-label {
      display: block;
      margin-bottom: 8px;
      color: #d4af37;
      font-size: 13px;
    }
    
    .switch-container {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 20px;
    }
    
    .switch {
      position: relative;
      display: inline-block;
      width: 50px;
      height: 24px;
    }
    
    .switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }
    
    .slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: #ccc;
      transition: .4s;
      border-radius: 24px;
    }
    
    .slider:before {
      position: absolute;
      content: "";
      height: 16px;
      width: 16px;
      left: 4px;
      bottom: 4px;
      background-color: white;
      transition: .4s;
      border-radius: 50%;
    }
    
    input:checked + .slider {
      background-color: #d4af37;
    }
    
    input:checked + .slider:before {
      transform: translateX(26px);
    }
    
    .crown-icon-large {
      position: absolute;
      top: -16px;
      right: 50%;
      transform: translateX(50%);
      font-size: 36px;
      color: #d4af37;
      text-shadow: 0 0 8px rgba(212, 175, 55, 0.7);
    }
    
    /* New styling for Alexai */
    .alexai-title {
      font-size: 1.8rem;
      text-shadow: 0 0 8px rgba(212, 175, 55, 0.5);
      letter-spacing: -0.5px;
      margin-bottom: 12px;
    }
    
    .chat-container {
      max-width: 900px;
      height: 75vh;
    }
    
    .chat-header {
      padding: 14px 20px;
    }
    
    .chat-content {
      height: calc(100% - 120px);
      padding: 12px;
    }
    
    /* Support conditions */
    .support-conditions {
      background: rgba(30, 30, 46, 0.3);
      border: 1px solid rgba(212, 175, 55, 0.2);
      border-radius: 10px;
      padding: 14px;
      margin-top: 14px;
      font-size: 12px;
    }
    
    .support-conditions h4 {
      color: #d4af37;
      margin-bottom: 10px;
      font-weight: 500;
      font-size: 14px;
    }
    
    .support-conditions ul {
      list-style-type: decimal;
      padding-right: 20px;
      color: #ccc;
      font-size: 12px;
    }
    
    .support-conditions li {
      margin-bottom: 6px;
    }
    
    .footer-details {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-top: 12px;
      font-size: 12px;
      color: rgba(255, 255, 255, 0.5);
    }
    
    .footer-details span {
      display: flex;
      align-items: center;
    }
    
    .footer-details i {
      margin-left: 6px;
      color: #d4af37;
    }
    
    /* Login screen */
    .login-screen {
      max-width: 420px;
      padding: 28px;
    }
    
    /* Chat input */
    #user-input {
      padding: 12px 14px;
      font-size: 14px;
    }
    
    /* Chat bubbles */
    .chat-bubble-user, .chat-bubble-bot {
      max-width: 85%;
      padding: 14px;
    }
    
    /* Chat avatar */
    .chat-avatar {
      width: 40px;
      height: 40px;
    }
    
    /* Small font adjustments */
    h1, h2, h3, h4 {
      font-weight: 500;
    }
    
    .text-sm {
      font-size: 11px;
    }
    
    .text-xs {
      font-size: 10px;
    }
  </style>
</head>
<body class="font-body flex flex-col items-center justify-center min-h-screen p-3 relative overflow-hidden">
  
  <!-- Blue Moon Background -->
  <div class="blue-moon"></div>
  
  <!-- Cookie Overlay -->
  <div id="cookie-overlay" class="cookie-overlay">
    <div class="cookie-modal">
      <div class="text-center mb-4">
        <div class="w-14 h-14 rounded-full bg-gradient-to-br from-luxury-gold to-amber-200 flex items-center justify-center mx-auto mb-3">
          <i class="fas fa-cookie text-luxury-darker text-xl"></i>
        </div>
        <h1 class="font-display text-xl text-luxury-gold mb-2">موافقة الكوكيز</h1>
        <p class="text-gray-400 text-xs">نستخدم كوكيز أساسية لتحسين تجربتك</p>
      </div>
      
      <p class="text-gray-300 text-xs mb-3">
        بالنقر على "قبول"، أنت توافق على استخدامنا للكوكيز الضرورية لعمل الموقع بشكل صحيح. سيتم تخزين بياناتك لمدة 30 يومًا.
      </p>
      
      <button id="accept-cookies" class="cookie-btn accept-btn">
        <i class="fas fa-check-circle ml-2"></i> قبول ومتابعة
      </button>
      <button id="reject-cookies" class="cookie-btn reject-btn">
        <i class="fas fa-times-circle ml-2"></i> رفض واستخدام كضيف
      </button>
      
      <div class="mt-3 text-xs text-gray-500">
        © 2025 آلقيـــــــــآدهہ‌‏ آلزعيـــم - Mohamed Abu Al-Saud | جميع الحقوق محفوظة
      </div>
    </div>
  </div>
  
  <!-- Menu Toggle -->
  <div class="menu-toggle" id="menu-toggle">
    <i class="fas fa-bars"></i>
  </div>
  
  <!-- Sidebar -->
  <div class="sidebar" id="sidebar">
    <div class="sidebar-btn" id="settings-btn">
      <span>الإعدادات</span>
      <i class="fas fa-cog"></i>
    </div>
    
    <div class="sidebar-btn" id="support-btn">
      <span>الدعم الفني</span>
      <i class="fas fa-headset"></i>
    </div>
    
    <div class="sidebar-btn" id="developer-btn">
      <span>المطور</span>
      <i class="fas fa-code"></i>
    </div>
    
    <div class="sidebar-btn" id="logout-btn">
      <span>تسجيل الخروج</span>
      <i class="fas fa-sign-out-alt"></i>
    </div>
    
    <div class="info-card mt-3">
      <div class="info-item">
        <i class="fas fa-user"></i>
        <span id="display-username">ضيف-1234</span>
      </div>
      <div class="info-item">
        <i class="fas fa-wifi"></i>
        <span id="ip-address">192.168.1.1</span>
      </div>
      <div class="info-item">
        <i class="fas fa-microchip"></i>
        <span id="browser-info">كروم 116</span>
      </div>
      <div class="info-item">
        <i class="fas fa-mobile-alt"></i>
        <span id="device-info">حاسوب</span>
      </div>
      <div class="info-item">
        <i class="fas fa-battery-three-quarters"></i>
        <span id="battery-status">85%</span>
      </div>
      <div class="info-item">
        <i class="fas fa-bolt"></i>
        <span id="ping-value">24ms <span class="ping-badge">جيد</span></span>
      </div>
    </div>
    
    <div id="guest-warning" class="guest-warning mt-3">
      <i class="fas fa-hourglass-half text-red-400 ml-2"></i>
      <span class="text-red-300 text-xs">جلسة ضيف مؤقتة - تنتهي خلال <span id="session-timer">60:00</span></span>
    </div>
  </div>
  
  <!-- Login Screen -->
  <div id="login-screen" class="glass-panel rounded-xl p-5 login-screen hidden">
    <div class="text-center mb-5">
      <div class="w-16 h-16 rounded-full bg-gradient-to-br from-luxury-gold to-amber-200 flex items-center justify-center mx-auto mb-3">
        <i class="fas fa-crown text-luxury-darker text-2xl"></i>
      </div>
      <h1 class="font-display text-xl text-luxury-gold mb-2 alexai-title">Alexai - محادثة الذكاء الاصطناعي الفاخرة</h1>
      <p class="text-gray-400 text-xs">تجربة محادثة ذكية فائقة الجودة</p>
    </div>
    
    <form id="login-form" class="space-y-4">
      <div>
        <label class="block text-gray-400 mb-2 text-xs">اسم المستخدم</label>
        <input type="text" id="username" class="w-full bg-luxury-light border-none text-white rounded-xl py-2 px-3 focus:ring-2 focus:ring-luxury-gold focus:outline-none placeholder-gray-500" placeholder="أدخل اسم المستخدم" required>
      </div>
      
      <div>
        <label class="block text-gray-400 mb-2 text-xs">كلمة المرور</label>
        <input type="password" id="password" class="w-full bg-luxury-light border-none text-white rounded-xl py-2 px-3 focus:ring-2 focus:ring-luxury-gold focus:outline-none placeholder-gray-500" placeholder="••••••••" required>
      </div>
      
      <button type="submit" class="w-full gold-gradient text-luxury-dark font-semibold py-2 rounded-xl">
        تسجيل الدخول <i class="fas fa-arrow-left ml-2"></i>
      </button>
    </form>
    
    <div class="text-center mt-4 text-gray-500 text-xs">
      <p>© 2025 آلقيـــــــــآدهہ‌‏ آلزعيـــم - Mohamed Abu Al-Saud | جميع الحقوق محفوظة</p>
    </div>
  </div>
  
  <!-- Main Chat Interface -->
  <div id="chat-interface" class="w-full max-w-5xl hidden">
    <div class="text-center mb-4">
      <h1 class="font-display text-xl text-luxury-gold mb-2 alexai-title">Alexai - محادثة الذكاء الاصطناعي الفاخرة</h1>
    </div>
    
    <!-- Chat Container -->
    <div class="w-full glass-panel rounded-xl overflow-hidden luxury-border chat-container">
      <!-- Header -->
      <div class="flex items-center justify-between p-3 border-b border-luxury-gray chat-header">
        <div class="flex items-center space-x-2">
          <div class="relative">
            <div class="w-10 h-10 rounded-full bg-gradient-to-br from-luxury-gold to-amber-200 flex items-center justify-center overflow-hidden chat-avatar">
              <img id="ai-avatar" src="https://cdn-icons-png.flaticon.com/512/4712/4712027.png" class="w-full h-full object-cover" alt="Alexai">
            </div>
            <div class="status-dot bg-green-500"></div>
          </div>
          <div>
            <h2 class="font-display text-lg text-white">Alexai</h2>
            <p class="text-gray-400 text-xs">ردود ذكية ومتقدمة</p>
          </div>
        </div>
      </div>
      
      <!-- Chat Content -->
      <div id="chat-content" class="h-[calc(100%-120px)] overflow-y-auto p-3 bg-luxury-darker scrollbar-custom flex flex-col space-y-3 chat-content">
        <div class="text-center py-2">
          <div class="inline-block bg-luxury-light rounded-full px-2 py-1">
            <p class="text-xs text-luxury-gold"><i class="fas fa-crown ml-1"></i>مرحباً بك في Alexai، نظام المحادثة الذكي الفاخر</p>
          </div>
        </div>
      </div>
      
      <!-- Input Area -->
      <div class="p-2 border-t border-luxury-gray bg-luxury-dark">
        <form id="chat-form" class="flex items-center space-x-2">
          <div class="flex-1 relative">
            <input 
              type="text" 
              id="user-input"
              placeholder="اكتب رسالتك هنا..." 
              class="w-full bg-luxury-light border-none text-white rounded-xl py-1 px-3 focus:ring-2 focus:ring-luxury-gold focus:outline-none placeholder-gray-500 text-sm"
              autocomplete="off"
            >
          </div>
          <button type="submit" class="w-10 h-10 rounded-full gold-gradient flex items-center justify-center pulse">
            <i class="fas fa-paper-plane text-luxury-dark text-base"></i>
          </button>
        </form>
      </div>
    </div>
    
    <!-- Footer -->
    <footer class="mt-4 text-center text-gray-500 text-xs w-full pt-3">
      <div class="flex justify-center items-center space-x-2 mb-2">
        <div class="flex items-center">
          <div class="w-2 h-2 rounded-full bg-green-500 ml-1"></div>
          <span>متصل</span>
        </div>
        <div class="flex items-center">
          <i class="fas fa-lock text-luxury-gold ml-1"></i>
          <span>مشفّر</span>
        </div>
      </div>
      <p class="mb-1">© 2025 آلقيـــــــــآدهہ‌‏ آلزعيـــم /p>
      <p>تم التطوير بواسطة <span class="text-luxury-gold">@A_Y_TR</span> | الإصدار 1.1</p>
      
      <div class="footer-details">
        <span><i class="fas fa-shield-alt"></i> </span>
        <span><i class="fas fa-rocket"></i> </span>
        <span><i class="fas fa-code"></i> </span>
      </div>
    </footer>
  </div>

  <!-- Developer Modal -->
  <div id="developer-modal" class="developer-modal hidden">
    <div class="developer-card">
      <div class="crown-icon-large">
        <i class="fas fa-crown"></i>
      </div>
      <button class="close-btn" id="close-dev-modal">
        <i class="fas fa-times"></i>
      </button>
      
      <img src="https://dev-ianstagram.pantheonsite.io/wp-content/uploads/2025/08/Screenshot_20250807_124407_Gallery.jpg" class="developer-avatar" alt="المطور">
      
      <h2 class="font-display text-xl text-luxury-gold mb-1">آلقـــــــيادهہ آلزعيـــم</h2>
      <p class="text-white font-medium mb-2">@A_Y_TR</p>
      <p class="text-gray-400 text-xs mb-3">مطور رئيسي وخبير أمني</p>
      
      <a href="https://t.me/cybersecurityTemDF" target="_blank" class="telegram-btn">
        <i class="fab fa-telegram ml-2"></i> التواصل عبر تيليجرام
      </a>
      
      <div class="mt-4 pt-3 border-t border-luxury-gray">
        <p class="text-gray-400 text-xs">"بناء تجارب رقمية فاخرة وآمنة للعالم"</p>
      </div>
    </div>
  </div>

  <!-- Settings Modal -->
  <div id="settings-modal" class="settings-modal hidden">
    <div class="settings-card">
      <div class="flex justify-between items-center mb-4">
        <h2 class="font-display text-xl text-luxury-gold">الإعدادات</h2>
        <button class="close-btn" id="close-settings">
          <i class="fas fa-times"></i>
        </button>
      </div>
      
      <div class="settings-grid">
        <div class="settings-item" data-setting="profile">
          <i class="fas fa-user-circle"></i>
          <div class="text-xs">الملف الشخصي</div>
        </div>
        <div class="settings-item" data-setting="password">
          <i class="fas fa-lock"></i>
          <div class="text-xs">كلمة المرور</div>
        </div>
        <div class="settings-item" data-setting="background">
          <i class="fas fa-image"></i>
          <div class="text-xs">الخلفية</div>
        </div>
        <div class="settings-item" data-setting="avatar">
          <i class="fas fa-robot"></i>
          <div class="text-xs">صورة المساعد</div>
        </div>
        <div class="settings-item" data-setting="cookies">
          <i class="fas fa-cookie"></i>
          <div class="text-xs">الكوكيز</div>
        </div>
      </div>
      
      <!-- Profile Settings -->
      <div id="profile-settings" class="settings-content hidden mt-5">
        <h3 class="font-medium text-lg mb-3">إعدادات الملف الشخصي</h3>
        <div class="flex items-center mb-3">
          <img id="current-avatar" src="https://cdn-icons-png.flaticon.com/512/4333/4333609.png" class="w-12 h-12 rounded-full border-2 border-luxury-gold ml-3" alt="صورة المستخدم">
          <div>
            <p class="text-xs mb-1">اختر صورتك:</p>
            <div class="avatar-grid">
              <img src="https://cdn-icons-png.flaticon.com/512/4333/4333609.png" class="avatar-option selected" data-avatar="1">
              <img src="https://cdn-icons-png.flaticon.com/512/4140/4140048.png" class="avatar-option" data-avatar="2">
              <img src="https://cdn-icons-png.flaticon.com/512/921/921071.png" class="avatar-option" data-avatar="3">
              <img src="https://cdn-icons-png.flaticon.com/512/4333/4333559.png" class="avatar-option" data-avatar="4">
              <img src="https://cdn-icons-png.flaticon.com/512/4140/4140047.png" class="avatar-option" data-avatar="5">
              <!-- صور بنات -->
              <img src="https://cdn-icons-png.flaticon.com/512/6997/6997662.png" class="avatar-option" data-avatar="6">
              <img src="https://cdn-icons-png.flaticon.com/512/6997/6997667.png" class="avatar-option" data-avatar="7">
              <img src="https://cdn-icons-png.flaticon.com/512/6997/6997665.png" class="avatar-option" data-avatar="8">
              <!-- صور أولاد -->
              <img src="https://cdn-icons-png.flaticon.com/512/6997/6997663.png" class="avatar-option" data-avatar="9">
              <img src="https://cdn-icons-png.flaticon.com/512/6997/6997664.png" class="avatar-option" data-avatar="10">
              <img src="https://cdn-icons-png.flaticon.com/512/6997/6997666.png" class="avatar-option" data-avatar="11">
            </div>
          </div>
        </div>
        <div class="mb-3">
          <label class="block text-gray-400 mb-2 text-xs">اسم المستخدم</label>
          <input type="text" id="profile-username" class="w-full bg-luxury-light border-none text-white rounded-xl py-1 px-3 focus:ring-2 focus:ring-luxury-gold focus:outline-none" value="مستخدم123">
        </div>
        <button id="save-profile" class="w-full gold-gradient text-luxury-dark font-medium py-2 rounded-xl">
          حفظ التغييرات
        </button>
      </div>
      
      <!-- Password Settings -->
      <div id="password-settings" class="settings-content hidden mt-5">
        <h3 class="font-medium text-lg mb-3">تغيير كلمة المرور</h3>
        <div class="mb-2">
          <label class="block text-gray-400 mb-2 text-xs">كلمة المرور الحالية</label>
          <input type="password" id="current-password" class="form-input" placeholder="أدخل كلمة المرور الحالية">
        </div>
        <div class="mb-2">
          <label class="block text-gray-400 mb-2 text-xs">كلمة المرور الجديدة</label>
          <input type="password" id="new-password-setting" class="form-input" placeholder="أدخل كلمة المرور الجديدة">
        </div>
        <div class="mb-3">
          <label class="block text-gray-400 mb-2 text-xs">تأكيد كلمة المرور الجديدة</label>
          <input type="password" id="confirm-new-password" class="form-input" placeholder="أعد إدخال كلمة المرور الجديدة">
        </div>
        <button id="save-password" class="w-full gold-gradient text-luxury-dark font-medium py-2 rounded-xl">
          تغيير كلمة المرور
        </button>
      </div>
      
      <!-- Background Settings -->
      <div id="background-settings" class="settings-content hidden mt-5">
        <h3 class="font-medium text-lg mb-3">تغيير الخلفية</h3>
        <p class="text-gray-400 text-xs mb-2">اختر سمة الخلفية:</p>
        
        <div class="background-option selected" data-bg="default" style="background: linear-gradient(135deg, #0a0a0a 0%, #121212 100%);"></div>
        <div class="background-option" data-bg="blue" style="background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);"></div>
        <div class="background-option" data-bg="purple" style="background: linear-gradient(135deg, #1e0a3a 0%, #2d1060 100%);"></div>
        <div class="background-option" data-bg="green" style="background: linear-gradient(135deg, #0a341a 0%, #14532d 100%);"></div>
        <div class="background-option" data-bg="space" style="background: linear-gradient(135deg, #000428 0%, #004e92 100%);"></div>
        <div class="background-option" data-bg="sunset" style="background: linear-gradient(135deg, #ff7e5f 0%, #feb47b 100%);"></div>
        <div class="background-option" data-bg="galaxy" style="background: linear-gradient(135deg, #0f0c29 0%, #302b63 50%, #24243e 100%);"></div>
        <div class="background-option" data-bg="ocean" style="background: linear-gradient(135deg, #0052D4 0%, #65C7F7 50%, #9CECFB 100%);"></div>
        <div class="background-option" data-bg="gold" style="background: linear-gradient(135deg, #1a1a1a 0%, #d4af37 100%);"></div>
        
        <button id="save-background" class="w-full gold-gradient text-luxury-dark font-medium py-2 rounded-xl mt-3">
          تطبيق الخلفية
        </button>
      </div>
      
      <!-- Avatar Settings -->
      <div id="avatar-settings" class="settings-content hidden mt-5">
        <h3 class="font-medium text-lg mb-3">تغيير صورة المساعد</h3>
        <p class="text-gray-400 text-xs mb-2">اختر صورة لمساعد الذكاء الاصطناعي:</p>
        
        <div class="flex flex-wrap justify-center">
          <img src="https://cdn-icons-png.flaticon.com/512/4712/4712027.png" class="ai-avatar-option selected" data-ai-avatar="1">
          <img src="https://cdn-icons-png.flaticon.com/512/4712/4712035.png" class="ai-avatar-option" data-ai-avatar="2">
          <img src="https://cdn-icons-png.flaticon.com/512/4712/4712055.png" class="ai-avatar-option" data-ai-avatar="3">
        </div>
        
        <button id="save-avatar" class="w-full gold-gradient text-luxury-dark font-medium py-2 rounded-xl mt-3">
          تطبيق الصورة
        </button>
      </div>
      
      <!-- Cookies Settings -->
      <div id="cookies-settings" class="settings-content hidden mt-5">
        <h3 class="font-medium text-lg mb-3">إعدادات الكوكيز</h3>
        <p class="text-gray-400 text-xs mb-3">إدارة تفضيلات الكوكيز:</p>
        
        <div class="mb-3">
          <div class="switch-container">
            <span class="text-white">الكوكيز الأساسية</span>
            <label class="switch">
              <input type="checkbox" checked disabled>
              <span class="slider round"></span>
            </label>
          </div>
          <p class="text-gray-400 text-xs">ضرورية لعمل الموقع بشكل صحيح. لا يمكن تعطيلها.</p>
        </div>
        
        <div class="mb-3">
          <div class="switch-container">
            <span class="text-white">الكوكيز التحليلية</span>
            <label class="switch">
              <input type="checkbox" id="analytics-cookies" checked>
              <span class="slider round"></span>
            </label>
          </div>
          <p class="text-gray-400 text-xs">تساعدنا في تحسين تجربة المستخدم.</p>
        </div>
        
        <div class="mb-3">
          <div class="switch-container">
            <span class="text-white">كوكيز التسويق</span>
            <label class="switch">
              <input type="checkbox" id="marketing-cookies">
              <span class="slider round"></span>
            </label>
          </div>
          <p class="text-gray-400 text-xs">تستخدم لتقديم محتوى مخصص.</p>
        </div>
        
        <button id="clear-cookies" class="w-full bg-red-900/30 text-white font-medium py-2 rounded-xl border border-red-700 mb-2">
          <i class="fas fa-trash-alt ml-2"></i> حذف جميع الكوكيز
        </button>
        
        <button id="save-cookies" class="w-full gold-gradient text-luxury-dark font-medium py-2 rounded-xl">
          حفظ التفضيلات
        </button>
      </div>
    </div>
  </div>

  <!-- Help Modal -->
  <div id="help-modal" class="help-modal hidden">
    <div class="help-card">
      <div class="flex justify-between items-center mb-4">
        <h2 class="font-display text-xl text-luxury-gold">مركز الدعم</h2>
        <button class="close-btn" id="close-help">
          <i class="fas fa-times"></i>
        </button>
      </div>
      
      <p class="text-gray-400 text-xs mb-3">صِف مشكلتك وسنتواصل معك للحصول على الدعم:</p>
      
      <textarea id="help-message" class="help-input" placeholder="صِف مشكلتك هنا..." rows="4"></textarea>
      
      <!-- Support Conditions -->
      <div class="support-conditions">
        <h4>شروط الحصول على الدعم:</h4>
        <ul>
          <li>يجب أن تكون المشكلة فنية تتعلق بتشغيل النظام</li>
          <li>يجب أن تكون المشكلة قابلة للتكرار وواضحة الوصف</li>
          <li>يجب تقديم معلومات كافية عن الجهاز والمتصفح المستخدم</li>
        </ul>
      </div>
      
      <button id="send-help" class="w-full gold-gradient text-luxury-dark font-medium py-2 rounded-xl">
        <i class="fas fa-paper-plane ml-2"></i> إرسال إلى دعم تيليجرام
      </button>
    </div>
  </div>

  <!-- Save Notification -->
  <div id="save-notification" class="save-notification">
    <i class="fas fa-check-circle ml-2"></i> تم حفظ الإعدادات بنجاح!
  </div>

  <!-- Copyright -->
  <div class="copyright">
    © 2025 آلقيـــــــــآدهہ‌‏ آلزعيـــم - Mohamed Abu Al-Saud. جميع الحقوق محفوظة. يُمنع الاستخدام غير المصرح به.
  </div>

  <script>
    // DOM Elements
    const menuToggle = document.getElementById('menu-toggle');
    const sidebar = document.getElementById('sidebar');
    const chatInterface = document.getElementById('chat-interface');
    const chatForm = document.getElementById('chat-form');
    const chatContent = document.getElementById('chat-content');
    const userInput = document.getElementById('user-input');
    const usernameDisplay = document.getElementById('display-username');
    const ipAddress = document.getElementById('ip-address');
    const developerBtn = document.getElementById('developer-btn');
    const developerModal = document.getElementById('developer-modal');
    const closeDevModal = document.getElementById('close-dev-modal');
    const settingsBtn = document.getElementById('settings-btn');
    const settingsModal = document.getElementById('settings-modal');
    const closeSettings = document.getElementById('close-settings');
    const supportBtn = document.getElementById('support-btn');
    const helpModal = document.getElementById('help-modal');
    const closeHelp = document.getElementById('close-help');
    const sendHelp = document.getElementById('send-help');
    const guestWarning = document.getElementById('guest-warning');
    const sessionTimer = document.getElementById('session-timer');
    const pingValue = document.getElementById('ping-value');
    const batteryStatus = document.getElementById('battery-status');
    const currentAvatar = document.getElementById('current-avatar');
    const aiAvatar = document.getElementById('ai-avatar');
    const logoutBtn = document.getElementById('logout-btn');
    const saveNotification = document.getElementById('save-notification');
    const browserInfo = document.getElementById('browser-info');
    const deviceInfo = document.getElementById('device-info');
    const loginScreen = document.getElementById('login-screen');
    const cookieOverlay = document.getElementById('cookie-overlay');
    const acceptCookies = document.getElementById('accept-cookies');
    const rejectCookies = document.getElementById('reject-cookies');
    const loginForm = document.getElementById('login-form');

    // User data and state
    let currentUser = null;
    let sessionTimeLeft = 3600; // 1 hour in seconds
    let guestSessionTimer = null;
    let currentBackground = 'default';
    let currentAiAvatar = '1';
    let currentUserAvatar = '1';
    let messages = [];
    let cookiesEnabled = false;

    // Cookie management functions
    function setCookie(name, value, days) {
      let expires = "";
      if (days) {
        const date = new Date();
        date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
        expires = "; expires=" + date.toUTCString();
      }
      document.cookie = name + "=" + (value || "") + expires + "; path=/";
    }

    function getCookie(name) {
      const nameEQ = name + "=";
      const ca = document.cookie.split(';');
      for (let i = 0; i < ca.length; i++) {
        let c = ca[i];
        while (c.charAt(0) === ' ') c = c.substring(1, c.length);
        if (c.indexOf(nameEQ) === 0) return c.substring(nameEQ.length, c.length);
      }
      return null;
    }

    function deleteCookie(name) {
      document.cookie = name + '=; Path=/; Expires=Thu, 01 Jan 1970 00:00:01 GMT;';
    }

    function saveUserSettings() {
      if (!currentUser || !cookiesEnabled) return;
      
      const userSettings = {
        username: currentUser.username,
        avatar: 'https://cdn-icons-png.flaticon.com/512/4333/4333609.png',
        background: currentBackground,
        aiAvatar: currentAiAvatar,
        timestamp: new Date().getTime()
      };
      
      setCookie('luxuryChatUser', JSON.stringify(userSettings), 30);
    }

    function loadUserSettings() {
      const userCookie = getCookie('luxuryChatUser');
      if (!userCookie) return;
      
      try {
        const userSettings = JSON.parse(userCookie);
        if (!userSettings) return;
        
        // Apply settings
        if (userSettings.username) {
          currentUser = {
            username: userSettings.username,
            avatar: 'https://cdn-icons-png.flaticon.com/512/4333/4333609.png',
            isGuest: false,
            loginTime: new Date().toISOString()
          };
          
          // Update UI
          usernameDisplay.textContent = currentUser.username;
          currentAvatar.src = currentUser.avatar;
          
          // Hide login screen, show chat
          loginScreen.classList.add('hidden');
          cookieOverlay.classList.add('hidden');
          chatInterface.classList.remove('hidden');
          
          // Add welcome message
          setTimeout(() => {
            addMessageToChat(`مرحباً بك مرة أخرى ${currentUser.username}! كيف يمكنني مساعدتك اليوم؟`, 'ai');
          }, 500);
          
          // Apply saved settings
          if (userSettings.background) {
            applyBackground(userSettings.background);
          }
          
          if (userSettings.aiAvatar) {
            aiAvatar.src = getAiAvatarUrl(userSettings.aiAvatar);
            currentAiAvatar = userSettings.aiAvatar;
          }
        }
      } catch (e) {
        console.error('Error loading user settings:', e);
      }
    }

    function applyBackground(bg) {
      const backgrounds = {
        'default': 'linear-gradient(135deg, #0a0a0a 0%, #121212 100%)',
        'blue': 'linear-gradient(135deg, #0f172a 0%, #1e293b 100%)',
        'purple': 'linear-gradient(135deg, #1e0a3a 0%, #2d1060 100%)',
        'green': 'linear-gradient(135deg, #0a341a 0%, #14532d 100%)',
        'space': 'linear-gradient(135deg, #000428 0%, #004e92 100%)',
        'sunset': 'linear-gradient(135deg, #ff7e5f 0%, #feb47b 100%)',
        'galaxy': 'linear-gradient(135deg, #0f0c29 0%, #302b63 50%, #24243e 100%)',
        'ocean': 'linear-gradient(135deg, #0052D4 0%, #65C7F7 50%, #9CECFB 100%)',
        'gold': 'linear-gradient(135deg, #1a1a1a 0%, #d4af37 100%)'
      };
      
      if (backgrounds[bg]) {
        document.body.style.background = backgrounds[bg];
        currentBackground = bg;
      }
    }

    function getAiAvatarUrl(avatarId) {
      switch(avatarId) {
        case '1': return 'https://cdn-icons-png.flaticon.com/512/4712/4712027.png';
        case '2': return 'https://cdn-icons-png.flaticon.com/512/4712/4712035.png';
        case '3': return 'https://cdn-icons-png.flaticon.com/512/4712/4712055.png';
        default: return 'https://cdn-icons-png.flaticon.com/512/4712/4712027.png';
      }
    }

    // Initialize
    document.addEventListener('DOMContentLoaded', function() {
      // Load saved settings if available
      loadUserSettings();
      
      // Set random ping value
      const ping = Math.floor(10 + Math.random() * 40);
      pingValue.textContent = `${ping}ms `;
      
      // Get device info
      getDeviceInfo();
      
      // Show cookie overlay if no settings loaded
      if (!getCookie('luxuryChatUser')) {
        cookieOverlay.style.display = 'flex';
      }
    });

    // Cookie consent
    acceptCookies.addEventListener('click', function() {
      cookiesEnabled = true;
      setCookie('cookieConsent', 'accepted', 30);
      cookieOverlay.style.display = 'none';
      loginScreen.classList.remove('hidden');
    });
    
    rejectCookies.addEventListener('click', function() {
      cookiesEnabled = false;
      setCookie('cookieConsent', 'rejected', 30);
      cookieOverlay.style.display = 'none';
      createGuestSession();
    });

    // Create guest session
    function createGuestSession() {
      const guestId = Math.floor(1000 + Math.random() * 9000);
      currentUser = {
        username: `ضيف-${guestId}`,
        avatar: 'https://cdn-icons-png.flaticon.com/512/4333/4333609.png',
        isGuest: true,
        loginTime: new Date().toISOString()
      };
      
      // Show guest warning
      guestWarning.classList.remove('hidden');
      
      // Start session timer
      startSessionTimer();
      
      // Show chat interface
      chatInterface.classList.remove('hidden');
      loginScreen.classList.add('hidden');
      
      // Update UI
      usernameDisplay.textContent = currentUser.username;
      currentAvatar.src = currentUser.avatar;
      
      // Add welcome message
      setTimeout(() => {
        addMessageToChat('مرحباً بك في Alexai، نظام المحادثة الذكي الفاخر! أنت تستخدم جلسة ضيف مؤقتة تنتهي خلال ساعة واحدة.', 'ai');
      }, 500);
    }
    
    // Start session timer
    function startSessionTimer() {
      guestSessionTimer = setInterval(() => {
        sessionTimeLeft--;
        
        // Update timer display
        const minutes = Math.floor(sessionTimeLeft / 60);
        const seconds = sessionTimeLeft % 60;
        sessionTimer.textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
        
        // End session when time is up
        if (sessionTimeLeft <= 0) {
          clearInterval(guestSessionTimer);
          alert('لقد انتهت جلسة الضيف الخاصة بك. سيتم إعادة تحميل الصفحة.');
          location.reload();
        }
      }, 1000);
    }
    
    // Add message to chat
    function addMessageToChat(text, sender) {
      const isUser = sender === 'user';
      const messageId = Date.now();
      const messageData = {
        id: messageId,
        text: text,
        sender: sender,
        timestamp: new Date().toISOString()
      };
      
      messages.push(messageData);
      
      const messageContainer = document.createElement('div');
      messageContainer.className = `message-container flex items-start space-x-2 ${isUser ? 'justify-end' : 'justify-start'}`;
      messageContainer.id = `message-${messageId}`;
      
      let messageContent = escapeHtml(text);
      
      // Check for code blocks
      if (text.includes('```')) {
        const codeBlocks = text.split('```');
        messageContent = '';
        
        for (let i = 0; i < codeBlocks.length; i++) {
          if (i % 2 === 0) {
            // Regular text
            messageContent += escapeHtml(codeBlocks[i]);
          } else {
            // Code block
            const code = codeBlocks[i].trim();
            const language = code.split('\n')[0] || 'javascript';
            const codeContent = code.substring(language.length).trim();
            
            messageContent += `
              <div class="code-block mt-2 mb-3">
                <div class="code-header">
                  <span class="language-badge">${language}</span>
                  <button class="copy-btn" data-code="${escapeHtml(codeContent)}">
                    <i class="fas fa-copy ml-1"></i> نسخ
                  </button>
                </div>
                <pre><code class="language-${language}">${escapeHtml(codeContent)}</code></pre>
              </div>
            `;
          }
        }
      }
      
      let actionsHTML = '';
      
      if (isUser) {
        actionsHTML = `
          <div class="message-actions">
            <div class="action-btn edit-btn">
              <i class="fas fa-edit ml-1"></i> تعديل
            </div>
            <div class="action-btn copy-btn">
              <i class="fas fa-copy ml-1"></i> نسخ
            </div>
          </div>
        `;
      } else {
        actionsHTML = `
          <div class="message-actions">
            <div class="action-btn copy-btn">
              <i class="fas fa-copy ml-1"></i> نسخ
            </div>
          </div>
        `;
      }
      
      if (!isUser) {
        messageContainer.innerHTML = `
          <div class="flex-shrink-0">
            <div class="w-8 h-8 rounded-full bg-gradient-to-br from-luxury-gold to-amber-200 flex items-center justify-center overflow-hidden">
              <img src="${aiAvatar.src}" class="w-full h-full object-cover" alt="Alexai">
            </div>
          </div>
          <div class="chat-bubble-bot">
            <div class="text-white">${messageContent}</div>
            ${actionsHTML}
          </div>
        `;
      } else {
        messageContainer.innerHTML = `
          <div class="chat-bubble-user">
            <div>${messageContent}</div>
            ${actionsHTML}
          </div>
          <div class="flex-shrink-0">
            <div class="w-8 h-8 rounded-full bg-gradient-to-br from-gray-700 to-gray-800 flex items-center justify-center overflow-hidden">
              <img src="${currentAvatar.src}" class="w-full h-full object-cover" alt="المستخدم">
            </div>
          </div>
        `;
      }
      
      chatContent.appendChild(messageContainer);
      
      // Highlight code blocks
      document.querySelectorAll('pre code').forEach((block) => {
        hljs.highlightElement(block);
      });
      
      // Add event listeners to action buttons
      const messageElement = document.getElementById(`message-${messageId}`);
      const copyBtns = messageElement.querySelectorAll('.copy-btn');
      const editBtn = messageElement.querySelector('.edit-btn');
      
      copyBtns.forEach(btn => {
        btn.addEventListener('click', function() {
          navigator.clipboard.writeText(text).then(() => {
            showSaveNotification('تم نسخ الرسالة بنجاح!');
          });
        });
      });
      
      if (editBtn) {
        editBtn.addEventListener('click', function() {
          const messageText = messageData.text;
          userInput.value = messageText;
          userInput.focus();
          // Remove the message from UI and messages array
          messageElement.remove();
          messages = messages.filter(msg => msg.id !== messageId);
        });
      }
      
      scrollToBottom();
    }
    
    // Show save notification
    function showSaveNotification(text) {
      saveNotification.innerHTML = `<i class="fas fa-check-circle ml-2"></i> ${text}`;
      saveNotification.classList.add('show');
      setTimeout(() => {
        saveNotification.classList.remove('show');
      }, 3000);
    }
    
    // Escape HTML to prevent XSS
    function escapeHtml(unsafe) {
      return unsafe
        .replace(/&/g, "&amp;")
        .replace(/</g, "&lt;")
        .replace(/>/g, "&gt;")
        .replace(/"/g, "&quot;")
        .replace(/'/g, "&#039;");
    }
    
    // Scroll to bottom of chat
    function scrollToBottom() {
      chatContent.scrollTop = chatContent.scrollHeight;
    }
    
    // Fetch AI response
    async function fetchResponse(userMessage) {
      try {
        // Check if user asked about developer
        const lowerMessage = userMessage.toLowerCase();
        if (lowerMessage.includes("من صنعك") || 
            lowerMessage.includes("من مطورك") || 
            lowerMessage.includes("من صنع هذا") || 
            lowerMessage.includes("المطور") ||
            lowerMessage.includes("من صنعك") ||
            lowerMessage.includes("من صممك") ||
            lowerMessage.includes("من أنشأك")) {
          return "أنا Alexai، نموذج ذكاء اصطناعي تجريبي. تم تطويري بواسطة آلقيـــــــــآدهہ‌‏ آلزعيـــم - Mohamed Abu Al-Saud";
        }
        
        const response = await fetch("https://backend.buildpicoapps.com/aero/run/llm-api?pk=v1-Z0FBQUFBQm5IZkJDMlNyYUVUTjIyZVN3UWFNX3BFTU85SWpCM2NUMUk3T2dxejhLSzBhNWNMMXNzZlp3c09BSTR6YW1Sc1BmdGNTVk1GY0liT1RoWDZZX1lNZlZ0Z1dqd3c9PQ==", {
          method: "POST",
          headers: {
            "Content-Type": "application/json"
          },
          body: JSON.stringify({
            prompt: userMessage
          })
        });
        
        if (!response.ok) {
          console.error("Error:", response.statusText);
          return "حدث خطأ. يرجى المحاولة مرة أخرى لاحقًا.";
        }
        
        const data = await response.json();
        
        if (data.status === "success") {
          return data.text;
        } else {
          console.error("Error:", data);
          return "حدث خطأ. يرجى المحاولة مرة أخرى لاحقًا.";
        }
      } catch (error) {
        console.error("Error:", error);
        return "حدث خطأ. يرجى المحاولة مرة أخرى لاحقًا.";
      }
    }
    
    // Get device info
    function getDeviceInfo() {
      // Browser info
      const userAgent = navigator.userAgent;
      let browserName = "غير معروف";
      
      if (userAgent.includes("Chrome")) browserName = "كروم";
      else if (userAgent.includes("Firefox")) browserName = "فايرفوكس";
      else if (userAgent.includes("Safari")) browserName = "سفاري";
      else if (userAgent.includes("Edge")) browserName = "إدج";
      else if (userAgent.includes("Opera")) browserName = "أوبرا";
      
      const browserVersion = userAgent.match(/(?:Chrome|Firefox|Safari|Edge|Opera)[\/\s](\d+)/);
      const version = browserVersion ? browserVersion[1] : "غير معروف";
      
      browserInfo.textContent = `${browserName} ${version}`;
      
      // Device type
      const isMobile = /iPhone|iPad|iPod|Android/i.test(userAgent);
      deviceInfo.textContent = isMobile ? "جوال" : "حاسوب";
      
      // IP Address (using a public API)
      fetch('https://api.ipify.org?format=json')
        .then(response => response.json())
        .then(data => {
          ipAddress.textContent = data.ip;
        })
        .catch(() => {
          ipAddress.textContent = "192.168.1.1";
        });
        
      // Battery status
      if ('getBattery' in navigator) {
        navigator.getBattery().then(battery => {
          batteryStatus.textContent = `${Math.round(battery.level * 100)}%`;
        });
      }
    }
    
    // Login user
    function loginUser(username) {
      currentUser = {
        username: username,
        avatar: 'https://cdn-icons-png.flaticon.com/512/4333/4333609.png',
        isGuest: false,
        loginTime: new Date().toISOString()
      };
      
      // Save to cookies
      saveUserSettings();
      
      // Show chat interface
      chatInterface.classList.remove('hidden');
      loginScreen.classList.add('hidden');
      
      // Update UI
      usernameDisplay.textContent = currentUser.username;
      currentAvatar.src = currentUser.avatar;
      
      // Hide guest warning
      guestWarning.classList.add('hidden');
      
      // Add welcome message
      setTimeout(() => {
        addMessageToChat(`مرحباً بك ${username} في Alexai، نظام المحادثة الذكي الفاخر! كيف يمكنني مساعدتك اليوم؟`, 'ai');
      }, 500);
    }

    // Event Listeners
    chatForm.addEventListener('submit', async function(e) {
      e.preventDefault();
      
      const message = userInput.value.trim();
      if (!message) return;
      
      // Add user message to chat
      addMessageToChat(message, 'user');
      userInput.value = '';
      
      // Get AI response
      const response = await fetchResponse(message);
      
      // Add AI response to chat
      addMessageToChat(response, 'ai');
    });

    // Menu toggle
    menuToggle.addEventListener('click', function() {
      sidebar.classList.toggle('active');
    });
    
    // Developer modal
    developerBtn.addEventListener('click', function() {
      developerModal.classList.remove('hidden');
    });
    
    closeDevModal.addEventListener('click', function() {
      developerModal.classList.add('hidden');
    });
    
    // Settings modal
    settingsBtn.addEventListener('click', function() {
      settingsModal.classList.remove('hidden');
      // Show the settings grid by default
      document.querySelectorAll('.settings-content').forEach(el => {
        el.classList.add('hidden');
      });
    });
    
    closeSettings.addEventListener('click', function() {
      settingsModal.classList.add('hidden');
    });
    
    // Help modal
    supportBtn.addEventListener('click', function() {
      helpModal.classList.remove('hidden');
    });
    
    closeHelp.addEventListener('click', function() {
      helpModal.classList.add('hidden');
    });
    
    // Send help message
    sendHelp.addEventListener('click', function() {
      const message = document.getElementById('help-message').value.trim();
      if (!message) {
        showSaveNotification('الرجاء وصف مشكلتك');
        return;
      }
      
      const telegramUrl = `https://t.me/cybersecurityTemDF?text=${encodeURIComponent(message)}`;
      window.open(telegramUrl, '_blank');
      helpModal.classList.add('hidden');
      showSaveNotification('تم فتح رسالتك في تيليجرام. يرجى إرسالها إلى فريق الدعم لدينا.');
    });
    
    // Settings items
    document.querySelectorAll('.settings-item').forEach(item => {
      item.addEventListener('click', function() {
        const setting = this.getAttribute('data-setting');
        
        // Hide all settings content
        document.querySelectorAll('.settings-content').forEach(el => {
          el.classList.add('hidden');
        });
        
        // Show selected setting
        document.getElementById(`${setting}-settings`).classList.remove('hidden');
      });
    });
    
    // Avatar selection
    document.querySelectorAll('.avatar-option').forEach(avatar => {
      avatar.addEventListener('click', function() {
        document.querySelectorAll('.avatar-option').forEach(el => {
          el.classList.remove('selected');
        });
        this.classList.add('selected');
        currentAvatar.src = this.src;
        currentUserAvatar = this.getAttribute('data-avatar');
        if (!currentUser.isGuest) {
          saveUserSettings();
        }
      });
    });
    
    // AI Avatar selection
    document.querySelectorAll('.ai-avatar-option').forEach(avatar => {
      avatar.addEventListener('click', function() {
        document.querySelectorAll('.ai-avatar-option').forEach(el => {
          el.classList.remove('selected');
        });
        this.classList.add('selected');
        aiAvatar.src = this.src;
        currentAiAvatar = this.getAttribute('data-ai-avatar');
        if (!currentUser.isGuest) {
          saveUserSettings();
        }
      });
    });
    
    // Background selection
    document.querySelectorAll('.background-option').forEach(bg => {
      bg.addEventListener('click', function() {
        document.querySelectorAll('.background-option').forEach(el => {
          el.classList.remove('selected');
        });
        this.classList.add('selected');
        currentBackground = this.getAttribute('data-bg');
        applyBackground(currentBackground);
        if (!currentUser.isGuest) {
          saveUserSettings();
        }
      });
    });
    
    // Apply background
    document.getElementById('save-background').addEventListener('click', function() {
      showSaveNotification('تم تطبيق الخلفية بنجاح!');
      setTimeout(() => {
        settingsModal.classList.add('hidden');
      }, 1000);
    });
    
    // Save profile
    document.getElementById('save-profile').addEventListener('click', function() {
      const newUsername = document.getElementById('profile-username').value;
      if (newUsername) {
        currentUser.username = newUsername;
        usernameDisplay.textContent = newUsername;
        showSaveNotification('تم تحديث الملف الشخصي بنجاح!');
        saveUserSettings();
        setTimeout(() => {
          settingsModal.classList.add('hidden');
        }, 1000);
      }
    });
    
    // Save cookies preferences
    document.getElementById('save-cookies').addEventListener('click', function() {
      const analytics = document.getElementById('analytics-cookies').checked;
      const marketing = document.getElementById('marketing-cookies').checked;
      
      localStorage.setItem('analyticsCookies', analytics);
      localStorage.setItem('marketingCookies', marketing);
      
      showSaveNotification('تم حفظ تفضيلات الكوكيز بنجاح!');
    });
    
    // Save AI avatar
    document.getElementById('save-avatar').addEventListener('click', function() {
      showSaveNotification('تم تغيير صورة المساعد بنجاح!');
      saveUserSettings();
      setTimeout(() => {
        settingsModal.classList.add('hidden');
      }, 1000);
    });
    
    // Clear cookies
    document.getElementById('clear-cookies').addEventListener('click', function() {
      if (confirm('هل أنت متأكد أنك تريد حذف جميع الكوكيز؟ سيتم تسجيل خروجك.')) {
        deleteCookie('luxuryChatUser');
        localStorage.clear();
        document.cookie.split(";").forEach(cookie => {
          const eqPos = cookie.indexOf("=");
          const name = eqPos > -1 ? cookie.substr(0, eqPos) : cookie;
          document.cookie = name + "=;expires=Thu, 01 Jan 1970 00:00:00 GMT;path=/";
        });
        location.reload();
      }
    });
    
    // Logout
    logoutBtn.addEventListener('click', function() {
      if (confirm('هل أنت متأكد أنك تريد تسجيل الخروج؟')) {
        deleteCookie('luxuryChatUser');
        location.reload();
      }
    });
    
    // Login form
    loginForm.addEventListener('submit', function(e) {
      e.preventDefault();
      const username = document.getElementById('username').value;
      if (username) {
        loginUser(username);
      }
    });
    
    // Close modals when clicking outside
    document.addEventListener('click', function(e) {
      if (e.target === developerModal) {
        developerModal.classList.add('hidden');
      }
      if (e.target === settingsModal) {
        settingsModal.classList.add('hidden');
      }
      if (e.target === helpModal) {
        helpModal.classList.add('hidden');
      }
    });
  </script>
</body>
</html>
